<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Rocksdb (ahrocksdb.Rocksdb)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">ahrocksdb</a> &#x00BB; Rocksdb</nav><h1>Module <code>Rocksdb</code></h1><p>A binding to RocksDB</p><p>This library is a binding to Facebook's RocksDB library. This library attempts to provide a layer on top of Rock's C FFI adapting it as much as possible to OCaml idioms. It aims to cover most of the C FFI in the long run, along with tests to ensure no function is left never called and untested.</p></header><dl><dt class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><code><span class="keyword">type</span> error</code> = <code>[ </code><table class="variant"><tr id="type-error.Msg" class="anchored"><td class="def constructor"><a href="#type-error.Msg" class="anchor"></a><code>| </code><code>`Msg <span class="keyword">of</span> string</code></td></tr></table><code> ]</code></dt></dl><div class="spec module" id="module-Options"><a href="#module-Options" class="anchor"></a><code><span class="keyword">module</span> <a href="Options/index.html">Options</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>Opaque database handle</p></dd></dl><dl><dt class="spec value" id="val-open_db"><a href="#val-open_db" class="anchor"></a><code><span class="keyword">val</span> open_db : <span>config:<a href="Options/index.html#type-config">Options.config</a></span> <span>&#45;&gt;</span> <span>name:string</span> <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>open_db options name</code> will return an handle to the database in case of success or the error returned by RocksDB in case of failure. <code>name</code> is the path to the database.</p></dd></dl><dl><dt class="spec value" id="val-open_db_read_only"><a href="#val-open_db_read_only" class="anchor"></a><code><span class="keyword">val</span> open_db_read_only : <span>?&#8288;fail_on_wal:bool</span> <span>&#45;&gt;</span> <span>config:<a href="Options/index.html#type-config">Options.config</a></span> <span>&#45;&gt;</span> <span>name:string</span> <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>open_db options name</code> will return a read-only handle to the database in case of success or the error returned by RocksDB in case of failure. <code>name</code> is the path to the database. <code>fail_on_wal</code> returns an error if write log is not empty</p></dd></dl><dl><dt class="spec value" id="val-open_db_with_ttl"><a href="#val-open_db_with_ttl" class="anchor"></a><code><span class="keyword">val</span> open_db_with_ttl : <span>config:<a href="Options/index.html#type-config">Options.config</a></span> <span>&#45;&gt;</span> <span>name:string</span> <span>&#45;&gt;</span> <span>ttl:int</span> <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>open_db_with_ttl options name ttl</code> will return an handle to the database in case of success or the error returned by RocksDB in case of failure. <code>name</code> is the path to the database. <code>ttl</code> Time in seconds after which a key should be removed (best-effort basis, during compaction)</p></dd></dl><dl><dt class="spec value" id="val-put"><a href="#val-put" class="anchor"></a><code><span class="keyword">val</span> put : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Options/Write_options/index.html#type-t">Options.Write_options.t</a> <span>&#45;&gt;</span> <span>key:string</span> <span>&#45;&gt;</span> <span>value:string</span> <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>put db write_options key value</code> will write at key <code>key</code> the value <code>value</code>, on database <code>db</code>. Return unit on success, RocksDB reported error on error.</p></dd></dl><dl><dt class="spec value" id="val-delete"><a href="#val-delete" class="anchor"></a><code><span class="keyword">val</span> delete : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Options/Write_options/index.html#type-t">Options.Write_options.t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>delete db write_options key</code> will delete key <code>key</code> on database <code>db</code>. Return unit on success, RocksDB reported error on error.</p></dd></dl><dl><dt class="spec value" id="val-get"><a href="#val-get" class="anchor"></a><code><span class="keyword">val</span> get : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Options/Read_options/index.html#type-t">Options.Read_options.t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(<span>[ `Not_found <span><span>| `Found</span> of string</span> ]</span>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>get db read_options key</code> will fetch key <code>key</code> on database <code>db</code>. Returns `Ok value if the key is found, `Not_found otherwise, and `Error if a failure occurred.</p></dd></dl><dl><dt class="spec value" id="val-flush"><a href="#val-flush" class="anchor"></a><code><span class="keyword">val</span> flush : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Options/Flush_options/index.html#type-t">Options.Flush_options.t</a> <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>flush db flush_options</code> will flush all pending memtables on database <code>db</code>. Return unit on success, RocksDB reported error on error.</p></dd></dl><dl><dt class="spec value" id="val-compact_now"><a href="#val-compact_now" class="anchor"></a><code><span class="keyword">val</span> compact_now : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>compact_now db</code> will initiate a compaction on all ranges available in database. This is an asynchronous operation, returning unit once operation is started.</p></dd></dl><dl><dt class="spec value" id="val-stats"><a href="#val-stats" class="anchor"></a><code><span class="keyword">val</span> stats : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(<span>string option</span>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>stats db</code> will return the accumulated stats for this database handle as an optional string form</p></dd></dl><dl><dt class="spec value" id="val-get_cache_usage"><a href="#val-get_cache_usage" class="anchor"></a><code><span class="keyword">val</span> get_cache_usage : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(int, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-close_db"><a href="#val-close_db" class="anchor"></a><code><span class="keyword">val</span> close_db : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(unit, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>close db</code> explicitly closes the db handle. Any further access will raise an error</p></dd></dl><dl><dt class="spec module" id="module-Batch"><a href="#module-Batch" class="anchor"></a><code><span class="keyword">module</span> <a href="Batch/index.html">Batch</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Batch processing RocksDB allows to batch operations through a dedicated batch object that must be fed to <a href="Batch/index.html#val-write"><code>write</code></a>. A batch object <a href="Batch/index.html#type-batch"><code>Batch.batch</code></a> is a collection of operation to run on a database. (like <a href="Batch/index.html#val-put"><code>Batch.put</code></a> or delete).</p></dd></dl><div class="spec module" id="module-Iterator"><a href="#module-Iterator" class="anchor"></a><code><span class="keyword">module</span> <a href="Iterator/index.html">Iterator</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Perf_context"><a href="#module-Perf_context" class="anchor"></a><code><span class="keyword">module</span> <a href="Perf_context/index.html">Perf_context</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></div></body></html>